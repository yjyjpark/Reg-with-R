<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 장 단순선형회귀모형의 추론 | R에 의한 회귀분석</title>
  <meta name="description" content="3 장 단순선형회귀모형의 추론 | R에 의한 회귀분석" />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="3 장 단순선형회귀모형의 추론 | R에 의한 회귀분석" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 장 단순선형회귀모형의 추론 | R에 의한 회귀분석" />
  
  
  

<meta name="author" content="박동련" />


<meta name="date" content="2024-02-21" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="simple-reg.html"/>
<link rel="next" href="multiple-reg.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>소개하기</a></li>
<li class="chapter" data-level="1" data-path="ch1.html"><a href="ch1.html"><i class="fa fa-check"></i><b>1</b> 회귀모형</a>
<ul>
<li class="chapter" data-level="1.1" data-path="ch1.html"><a href="ch1.html#반응변수와-설명변수-사이의-관계-설정"><i class="fa fa-check"></i><b>1.1</b> 반응변수와 설명변수 사이의 관계 설정</a></li>
<li class="chapter" data-level="1.2" data-path="ch1.html"><a href="ch1.html#회귀분석의-목적"><i class="fa fa-check"></i><b>1.2</b> 회귀분석의 목적</a></li>
<li class="chapter" data-level="1.3" data-path="ch1.html"><a href="ch1.html#회귀모형의-종류"><i class="fa fa-check"></i><b>1.3</b> 회귀모형의 종류</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="ch1.html"><a href="ch1.html#모수적-회귀모형"><i class="fa fa-check"></i><b>1.3.1</b> 모수적 회귀모형</a></li>
<li class="chapter" data-level="1.3.2" data-path="ch1.html"><a href="ch1.html#비모수적-회귀모형"><i class="fa fa-check"></i><b>1.3.2</b> 비모수적 회귀모형</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="ch1.html"><a href="ch1.html#r의-역할"><i class="fa fa-check"></i><b>1.4</b> R의 역할</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="simple-reg.html"><a href="simple-reg.html"><i class="fa fa-check"></i><b>2</b> 단순선형회귀모형</a>
<ul>
<li class="chapter" data-level="2.1" data-path="simple-reg.html"><a href="simple-reg.html#단순회귀모형의-설정"><i class="fa fa-check"></i><b>2.1</b> 단순회귀모형의 설정</a></li>
<li class="chapter" data-level="2.2" data-path="simple-reg.html"><a href="simple-reg.html#회귀계수의-최소제곱추정"><i class="fa fa-check"></i><b>2.2</b> 회귀계수의 최소제곱추정</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="simple-reg.html"><a href="simple-reg.html#모수-beta_0와-beta_1의-추정"><i class="fa fa-check"></i><b>2.2.1</b> 모수 <span class="math inline">\(\beta_{0}\)</span>와 <span class="math inline">\(\beta_{1}\)</span>의 추정</a></li>
<li class="chapter" data-level="2.2.2" data-path="simple-reg.html"><a href="simple-reg.html#section-property-lse"><i class="fa fa-check"></i><b>2.2.2</b> 최소제곱추정량의 특성</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="simple-reg.html"><a href="simple-reg.html#section-simple-sigma"><i class="fa fa-check"></i><b>2.3</b> 오차분산 <span class="math inline">\(\sigma^{2}\)</span>의 추정</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="simple-reg-infer.html"><a href="simple-reg-infer.html"><i class="fa fa-check"></i><b>3</b> 단순선형회귀모형의 추론</a>
<ul>
<li class="chapter" data-level="3.1" data-path="simple-reg-infer.html"><a href="simple-reg-infer.html#회귀계수-beta_1에-대한-추론"><i class="fa fa-check"></i><b>3.1</b> 회귀계수 <span class="math inline">\(\beta_{1}\)</span>에 대한 추론</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="simple-reg-infer.html"><a href="simple-reg-infer.html#hatbeta_1의-표본분포"><i class="fa fa-check"></i><b>3.1.1</b> <span class="math inline">\(\hat{\beta}_{1}\)</span>의 표본분포</a></li>
<li class="chapter" data-level="3.1.2" data-path="simple-reg-infer.html"><a href="simple-reg-infer.html#section-ci-beta1"><i class="fa fa-check"></i><b>3.1.2</b> <span class="math inline">\(\beta_{1}\)</span>의 신뢰구간</a></li>
<li class="chapter" data-level="3.1.3" data-path="simple-reg-infer.html"><a href="simple-reg-infer.html#section-test-beta1"><i class="fa fa-check"></i><b>3.1.3</b> <span class="math inline">\(\beta_{1}\)</span>에 대한 가설검정</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="simple-reg-infer.html"><a href="simple-reg-infer.html#회귀계수-beta_0에-대한-추론"><i class="fa fa-check"></i><b>3.2</b> 회귀계수 <span class="math inline">\(\beta_{0}\)</span>에 대한 추론</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="simple-reg-infer.html"><a href="simple-reg-infer.html#hatbeta_0-의-표본분포"><i class="fa fa-check"></i><b>3.2.1</b> <span class="math inline">\(\hat{\beta}_{0}\)</span> 의 표본분포</a></li>
<li class="chapter" data-level="3.2.2" data-path="simple-reg-infer.html"><a href="simple-reg-infer.html#beta_0의-신뢰구간"><i class="fa fa-check"></i><b>3.2.2</b> <span class="math inline">\(\beta_{0}\)</span>의 신뢰구간</a></li>
<li class="chapter" data-level="3.2.3" data-path="simple-reg-infer.html"><a href="simple-reg-infer.html#beta_0에-대한-가설검정"><i class="fa fa-check"></i><b>3.2.3</b> <span class="math inline">\(\beta_{0}\)</span>에 대한 가설검정</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="simple-reg-infer.html"><a href="simple-reg-infer.html#반응변수의-평균-eyx_o에-대한-신뢰구간-추정"><i class="fa fa-check"></i><b>3.3</b> 반응변수의 평균, <span class="math inline">\(E(Y|X_{o})\)</span>에 대한 신뢰구간 추정</a></li>
<li class="chapter" data-level="3.4" data-path="simple-reg-infer.html"><a href="simple-reg-infer.html#반응변수의-개별-관측값-예측"><i class="fa fa-check"></i><b>3.4</b> 반응변수의 개별 관측값 예측</a></li>
<li class="chapter" data-level="3.5" data-path="simple-reg-infer.html"><a href="simple-reg-infer.html#상관계수-두-변수-사이의-선형-연관성-측정"><i class="fa fa-check"></i><b>3.5</b> 상관계수 : 두 변수 사이의 선형 연관성 측정</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="multiple-reg.html"><a href="multiple-reg.html"><i class="fa fa-check"></i><b>4</b> 다중선형회귀모형</a>
<ul>
<li class="chapter" data-level="4.1" data-path="multiple-reg.html"><a href="multiple-reg.html#section-multi-model"><i class="fa fa-check"></i><b>4.1</b> 다중회귀모형의 설정</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="multiple-reg.html"><a href="multiple-reg.html#section-multi-fitting"><i class="fa fa-check"></i><b>4.1.1</b> 회귀계수의 추정</a></li>
<li class="chapter" data-level="4.1.2" data-path="multiple-reg.html"><a href="multiple-reg.html#다항회귀모형"><i class="fa fa-check"></i><b>4.1.2</b> 다항회귀모형</a></li>
<li class="chapter" data-level="4.1.3" data-path="multiple-reg.html"><a href="multiple-reg.html#section-dummy"><i class="fa fa-check"></i><b>4.1.3</b> 가변수 회귀모형</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="multiple-reg.html"><a href="multiple-reg.html#section-multi-infer"><i class="fa fa-check"></i><b>4.2</b> 다중회귀모형의 추론</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="multiple-reg.html"><a href="multiple-reg.html#회귀계수-추정량의-표본분포"><i class="fa fa-check"></i><b>4.2.1</b> 회귀계수 추정량의 표본분포</a></li>
<li class="chapter" data-level="4.2.2" data-path="multiple-reg.html"><a href="multiple-reg.html#section-multi-model-signif"><i class="fa fa-check"></i><b>4.2.2</b> 회귀모형의 유의성 검정</a></li>
<li class="chapter" data-level="4.2.3" data-path="multiple-reg.html"><a href="multiple-reg.html#개별-회귀계수-유의성-검정"><i class="fa fa-check"></i><b>4.2.3</b> 개별 회귀계수 유의성 검정</a></li>
<li class="chapter" data-level="4.2.4" data-path="multiple-reg.html"><a href="multiple-reg.html#두-회귀모형의-비교"><i class="fa fa-check"></i><b>4.2.4</b> 두 회귀모형의 비교</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="multiple-reg.html"><a href="multiple-reg.html#section-selection"><i class="fa fa-check"></i><b>4.3</b> 변수선택</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="multiple-reg.html"><a href="multiple-reg.html#section-fit-measure"><i class="fa fa-check"></i><b>4.3.1</b> 회귀모형의 평가 측도</a></li>
<li class="chapter" data-level="4.3.2" data-path="multiple-reg.html"><a href="multiple-reg.html#section-variable-criterion"><i class="fa fa-check"></i><b>4.3.2</b> 평가 측도에 의한 변수선택</a></li>
<li class="chapter" data-level="4.3.3" data-path="multiple-reg.html"><a href="multiple-reg.html#section-shrinkage"><i class="fa fa-check"></i><b>4.3.3</b> Shrinkage 방법</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="reg-diag.html"><a href="reg-diag.html"><i class="fa fa-check"></i><b>5</b> 회귀모형의 진단</a>
<ul>
<li class="chapter" data-level="5.1" data-path="reg-diag.html"><a href="reg-diag.html#section-assumption-error"><i class="fa fa-check"></i><b>5.1</b> 회귀모형에 대한 진단</a></li>
<li class="chapter" data-level="5.2" data-path="reg-diag.html"><a href="reg-diag.html#section-influence-data"><i class="fa fa-check"></i><b>5.2</b> 관찰값에 대한 진단</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R에 의한 회귀분석</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="simple-reg-infer" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">3 장</span> 단순선형회귀모형의 추론<a href="simple-reg-infer.html#simple-reg-infer" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>회귀모형의 추론에서 우리가 살펴볼 내용은 회귀계수에 대한 신뢰구간 추정 및 검정, 그리고
설명변수의 값이 주어졌을 때 반응변수의 조건부 평균에 대한 신뢰구간 추정 등이다.</p>
<p>이번 장에서 살펴볼 회귀모형은 다음의 단순회귀모형이다.</p>
<p><span class="math display" id="eq:simple-ch3-1">\[\begin{equation}
Y_{i} = \beta_{0} + \beta_{1}X_{i} + \varepsilon_{i}, ~~i = 1, \ldots, n
\tag{3.1}
\end{equation}\]</span></p>
<p><a href="simple-reg.html#simple-reg">2</a>장에서 회귀계수를 최소제곱추정량으로 추정하기 위해서 필요한 가정은 다음과 같다.</p>
<p><span class="math display">\[\begin{equation}
\varepsilon_{1}, \ldots, \varepsilon_{n} \text{은 서로 독립이고}~E(\varepsilon_{i})=0,~Var(\varepsilon_{i})=\sigma^{2}
\end{equation}\]</span></p>
<p>회귀모형의 추론을 위해서는 위 가정에 정규분포 가정이 추가된 다음의 가정이 필요하게 된다.</p>
<p><span class="math display" id="eq:error-assumption">\[\begin{equation}
\varepsilon_{1}, \ldots, \varepsilon_{n} \stackrel{iid}{\sim} N(0,\sigma^{2})
\tag{3.2}
\end{equation}\]</span></p>
<div id="회귀계수-beta_1에-대한-추론" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> 회귀계수 <span class="math inline">\(\beta_{1}\)</span>에 대한 추론<a href="simple-reg-infer.html#회귀계수-beta_1에-대한-추론" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>식 <a href="simple-reg-infer.html#eq:simple-ch3-1">(3.1)</a>에서 회귀계수 <span class="math inline">\(\beta_{1}\)</span>은 회귀직선의 기울기를 나타내는 모수로서,
설명변수 <span class="math inline">\(X\)</span>를 한 단위 증가시켰을 때 반응변수 <span class="math inline">\(Y\)</span>의 평균 변화량을 나타낸다.
회귀계수 <span class="math inline">\(\beta_{1}\)</span>의 점추정량은 <a href="simple-reg.html#simple-reg">2</a>장에서 살펴본 최소제곱추정량으로 구할 수 있었는데,
이번 절에서는 <span class="math inline">\(\beta_{1}\)</span>의 신뢰구간 추정과 가설검정에 대해 살펴보고자 한다.</p>
<p>식 <a href="simple-reg-infer.html#eq:simple-ch3-1">(3.1)</a>으로 설정된 회귀모형이 주어진 자료를 적절하게 설명하고 있는지 여부는 점추정 결과만으로는 알 수 없다.
추정 결과의 정확성 또는 적절성 등에 대한 접근은 관련된 회귀계수의 신뢰구간 추정을 통해 확인할 수 있다.
또한 주어진 자료를 근거로 가설 <span class="math inline">\(H_{0}:\beta_{1}=0\)</span> 에 대한 검정이 필요한데,
만일 가설을 기각할 수 없다면, 반응변수 <span class="math inline">\(Y\)</span>와 설명변수 <span class="math inline">\(X\)</span>의 관계가 식 <a href="simple-reg-infer.html#eq:simple-ch3-1">(3.1)</a>에서 설정한 선형관계로는 설명하기 어렵다는 것을 의미하기 때문이다.</p>
<p>이러한 추론을 실시하기 위해서는 회귀계수 <span class="math inline">\(\beta_{1}\)</span>의 점추정량인 <span class="math inline">\(\hat{\beta}_{1}\)</span>의 표본분포를 반드시 알고 있어야 한다.</p>
<div id="hatbeta_1의-표본분포" class="section level3 hasAnchor" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> <span class="math inline">\(\hat{\beta}_{1}\)</span>의 표본분포<a href="simple-reg-infer.html#hatbeta_1의-표본분포" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>식 <a href="simple-reg-infer.html#eq:simple-ch3-1">(3.1)</a>의 회귀모형에 식 <a href="simple-reg-infer.html#eq:error-assumption">(3.2)</a>에 주어진 오차항의 가정 사항을 적용시키면 설명변수 <span class="math inline">\(X_{i}\)</span>가 주어졌을 때 반응변수 <span class="math inline">\(Y_{i}\)</span>에 대한 분포는 다음과 같이 주어진다.</p>
<p><span class="math display">\[\begin{equation}
Y_{i} \stackrel{iid}{\sim} N(\beta_{0}+\beta_{1}X_{i}, \sigma^{2}),~~i=1, \ldots, n
\end{equation}\]</span></p>
<p><a href="simple-reg.html#simple-reg">2</a>장에서 유도한 회귀계수 <span class="math inline">\(\beta_{1}\)</span>의 최소제곱추정량인 <span class="math inline">\(\hat{\beta}_{1}\)</span>은 식 <a href="simple-reg.html#eq:lse-p1">(2.7)</a>에서 다음과 같이 반응변수 <span class="math inline">\(Y_{i}\)</span>의 선형결합으로 표현됨을 보였다.</p>
<p><span class="math display">\[\begin{equation}
\hat{\beta}_{1} = \sum_{i=1}^{n} c_{i}Y_{i},~~c_{i}= \frac{X_{i}-\overline{X}}{\sum_{i=1}^{n}(X_{i}-\overline{X})^{2}}
\end{equation}\]</span></p>
<p>즉, <span class="math inline">\(\hat{\beta}_{1}\)</span>은 정규분포를 하는 확률변수인 <span class="math inline">\(Y_{i}\)</span>의 선형결합으로 표현되기 때문에 <span class="math inline">\(\hat{\beta}_{1}\)</span>의 분포도 정규분포를 따르게 되는 것이다.
또한 식 <a href="simple-reg.html#eq:unbiased-beta1">(2.11)</a>와 식 <a href="simple-reg.html#eq:variance-beta1">(2.13)</a>에서 유도된 <span class="math inline">\(\hat{\beta}_{1}\)</span>의 평균과 분산을 적용시키면 <span class="math inline">\(\hat{\beta}_{1}\)</span>의 표본분포는 다음과 같이 주어진다.</p>
<p><span class="math display" id="eq:dist-beta1">\[\begin{equation}
\hat{\beta}_{1} \sim N \left( \beta_{1}, \frac{\sigma^{2}}{\sum_{i=1}^{n}(X_{i}-\overline{X})^{2}} \right)
\tag{3.3}
\end{equation}\]</span></p>
</div>
<div id="section-ci-beta1" class="section level3 hasAnchor" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> <span class="math inline">\(\beta_{1}\)</span>의 신뢰구간<a href="simple-reg-infer.html#section-ci-beta1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>모수 <span class="math inline">\(\beta_{1}\)</span>에 대한 신뢰구간은 하나의 숫자보다는 모수를 포함할 구간을 제시하는 것이며,
구간의 폭은 추정량의 표준오차에 비례하여 결정된다.
따라서 주어진 자료가 설정된 회귀모형에 의하여 잘 설명된다면 신뢰구간의 폭은 상대적으로 작은 값을 갖게 된다.</p>
<p>모수 <span class="math inline">\(\beta_{1}\)</span>의 신뢰구간은 모수의 불편추정량인 <span class="math inline">\(\hat{\beta}_{1}\)</span>의 표본분포를 활용해서 유도되는데, 우선 식 <a href="simple-reg-infer.html#eq:dist-beta1">(3.3)</a>에서 다음의 결과를 얻을 수 있다.</p>
<p><span class="math display">\[\begin{equation}
Z = \frac{\hat{\beta}_{1}-\beta_{1}}{\sqrt{\sigma^{2}/\sum_{i=1}^{n}(X_{i}-\overline{X})^{2}}} \sim N(0,1)
\end{equation}\]</span></p>
<p>식 <a href="simple-reg.html#eq:mse-1">(2.17)</a>에서 <span class="math inline">\(\sigma^{2}\)</span>의 불편추정량은 <span class="math inline">\(MSE\)</span>임이 확인되었고, 이제 <span class="math inline">\(\sigma^{2}\)</span>를 <span class="math inline">\(MSE\)</span>로 대체하면 다음의 결과를 얻게 된다.</p>
<p><span class="math display" id="eq:ci-beta1-1">\[\begin{equation}
t = \frac{\hat{\beta}_{1}-\beta_{1}}{\sqrt{MSE/\sum_{i=1}^{n}(X_{i}-\overline{X})^{2}}} \sim t(n-2)
\tag{3.4}
\end{equation}\]</span></p>
<p>단, <span class="math inline">\(t(n-2)\)</span>는 자유도가 <span class="math inline">\(n-2\)</span>인 <span class="math inline">\(t\)</span> 분포를 의미하는 것인데, 통계량 <span class="math inline">\(t\)</span>의 자유도는 분모에 사용된 <span class="math inline">\(MSE\)</span>의 자유도가 그대로 적용된다.</p>
<p>모수 <span class="math inline">\(\beta_{1}\)</span>의 <span class="math inline">\(100 \times (1-\alpha)\)</span>% 신뢰구간은 식 <a href="simple-reg-infer.html#eq:ci-beta1-1">(3.4)</a>을 이용해서 다음과 같이 유도된다.</p>
<p><span class="math display" id="eq:ci-beta1-2">\[\begin{align}
1-\alpha &amp; = P \left( -t_{\alpha, n-2} &lt; \frac{\hat{\beta}_{1}-\beta_{1}}{SE(\hat{\beta}_{1})} &lt; t_{\alpha, n-2} \right) \\
&amp; = P \left( \hat{\beta}_{1} - t_{\alpha, n-2} \cdot SE(\hat{\beta}_{1}) &lt; \beta_{1} &lt; \hat{\beta}_{1} + t_{\alpha, n-2} \cdot SE(\hat{\beta}_{1}) \right)
\tag{3.5}
\end{align}\]</span></p>
<p>단, <span class="math inline">\(SE(\hat{\beta}_{1})=\sqrt{MSE/\sum(X_{i}-\overline{X})^{2}}\)</span> 를 나타내고, <span class="math inline">\(t_{\alpha, n-2}\)</span> 는 자유도가 <span class="math inline">\(n-2\)</span>인 <span class="math inline">\(t\)</span> 분포에서 상위 <span class="math inline">\(100 \times \alpha\)</span> 백분위수를 나타낸다.</p>
<p>모수의 신뢰구간은 점추정량의 표본분포를 근거로 유도된 것이기 때문에, 식 <a href="simple-reg-infer.html#eq:ci-beta1-2">(3.5)</a>의 신뢰구간도 표본분포의 개념을 이용해서 해석해야 한다. 즉, 자료에 주어진 동일한 <span class="math inline">\(X\)</span> 값에 대해서 표본을 반복해서 추출하고, 추출된 각 표본마다 식 <a href="simple-reg-infer.html#eq:ci-beta1-2">(3.5)</a>에 의해 95% 신뢰구간을 계산한다면, 계산된 전체 신뢰구간 중 대략 95%의 신뢰구간에는 미지의 모수인 <span class="math inline">\(\beta_{1}\)</span>이 포함되지만 나머지 5%의 신뢰구간에는 <span class="math inline">\(\beta_{1}\)</span>이 포함되지 않을 수 있다는 것이다.
따라서 실제 상황에서 우리가 얻게 되는 하나의 표본을 대상으로 계산된 신뢰구간에는 <span class="math inline">\(\beta_{1}\)</span>이 포힘되어 있는지 여부를 알 수 없는 것이다.</p>
</div>
<div id="section-test-beta1" class="section level3 hasAnchor" number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> <span class="math inline">\(\beta_{1}\)</span>에 대한 가설검정<a href="simple-reg-infer.html#section-test-beta1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>기울기에 대한 가설검정은 <span class="math inline">\(\beta_{1}\)</span> 이 특정한 상수인 <span class="math inline">\(\beta_{1o}\)</span> 와 같은 값을 갖는지 여부에 대한 것이다.</p>
<p><span class="math display" id="eq:hypo-beta1-1">\[\begin{equation}
H_{0}:\beta_{1} = \beta_{1o}, ~~~H_{1}:\beta_{1} \ne \beta_{1o}
\tag{3.6}
\end{equation}\]</span></p>
<p>만일 <span class="math inline">\(\sigma^{2}\)</span> 가 알려져 있다면, 검정통계량은 다음과 같이 주어지며,</p>
<p><span class="math display" id="eq:test-beta1-1">\[\begin{equation}
Z= \frac{\hat{\beta}_{1}-\beta_{1o}}{\sqrt{\sigma^{2}/\sum_{i=1}^{n}(X_{i}-\overline{X})^{2}}}
\tag{3.7}
\end{equation}\]</span></p>
<p><span class="math inline">\(H_{0}\)</span>이 사실인 경우, 분포는 <span class="math inline">\(N(0,1)\)</span> 이 된다.</p>
<p>그러나 대부분의 상황에서는 <span class="math inline">\(\sigma^{2}\)</span> 의 값을 알기 어렵고, 따라서 <span class="math inline">\(MSE\)</span> 로 추정한 결과를 대신 사용하게 된다.
이 경우에 검정통계량은 다음과 같이 주어지며,</p>
<p><span class="math display" id="eq:test-beta1-2">\[\begin{equation}
t = \frac{\hat{\beta}_{1}-\beta_{1o}}{SE(\hat{\beta}_{1})}
\tag{3.8}
\end{equation}\]</span></p>
<p>단, <span class="math inline">\(SE(\hat{\beta}_{1}) = \sqrt{MSE/\sum_{i=1}^{n}(X_{i}-\overline{X})^{2}}\)</span>.</p>
<p><span class="math inline">\(H_{0}\)</span>이 사실인 경우, 검정통계량의 분포는 <span class="math inline">\(t(n-2)\)</span> 가 된다.</p>
<p>식 <a href="simple-reg-infer.html#eq:hypo-beta1-1">(3.6)</a>의 가설 중 가장 중요한 경우는 <span class="math inline">\(\beta_{1o}=0\)</span> 이 되며, 이것을 회귀계수 <span class="math inline">\(\beta_{1}\)</span>의 유의성 검정이라고 한다.</p>
<p><span class="math display" id="eq:hypo-beta1-2">\[\begin{equation}
H_{0}:\beta_{1}=0,~~~H_{1}:\beta_{1} \ne 0
\tag{3.9}
\end{equation}\]</span></p>
<p><span class="math inline">\(\beta_{1}\)</span>의 유의성 검정에서 사용되는 검정통계량은 식 <a href="simple-reg-infer.html#eq:test-beta1-2">(3.8)</a>에서 <span class="math inline">\(\beta_{1o}\)</span> 를 0으로 두는 형태가 된다.</p>
<p><span class="math display" id="eq:test-beta1-3">\[\begin{equation}
t = \frac{\hat{\beta}_{1}}{SE(\hat{\beta}_{1})}
\tag{3.10}
\end{equation}\]</span></p>
<p>주어진 자료를 근거로 만일 <span class="math inline">\(H_{0}\)</span> 을 기각할 수 없다면, 식 <a href="simple-reg-infer.html#eq:simple-ch3-1">(3.1)</a>에서 설정된 모형이 <span class="math inline">\(Y_{i}=\beta_{0}+\varepsilon_{i}\)</span> 로 변경되는 것이며, 따라서 설명변수 <span class="math inline">\(X\)</span>가 반응변수 <span class="math inline">\(Y\)</span>의 변동을 설명하는데 아무런 기여를 할 수 없다는 것을 의미하게 된다.
하지만 이것은 두 변수의 실제 관계가 선형이 아닌 경우에는 틀린 결론이 될 수 있다.
예시 자료를 활용해서 자세히 살펴보자.</p>
<p>그림 <a href="simple-reg-infer.html#fig:3-1-1">3.1</a>은 두 변수 사이에 관계가 없는 경우에 대한 예시로서, 설명변수가 반응변수의 변동을 설명하는데 어떤 역할도 할 수 없는 상황으로 보인다. 파란 직선은 추정된 회귀직선을 나타내고 있는데, <span class="math inline">\(H_{0}:\beta_{1}=0\)</span> 을 기각하기 어려운 상황으로 보인다.
실제 예시 자료를 근거로 가설 <span class="math inline">\(H_{0}:\beta_{1}=0, ~~H_{1}:\beta_{1} \ne 0\)</span> 에 대한 검정을 실시한 결과 p-값은 0.859으로 계산되어 <span class="math inline">\(H_{0}\)</span>은 기각할 수 없게 된다.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:3-1-1"></span>
<img src="_main_files/figure-html/3-1-1-1.png" alt="$H_{0}:\beta_{1}=0$을 기각할 수 없는 상황: 두 변수 사이에 관계가 없는 경우" width="480" />
<p class="caption">
그림 3.1: <span class="math inline">\(H_{0}:\beta_{1}=0\)</span>을 기각할 수 없는 상황: 두 변수 사이에 관계가 없는 경우
</p>
</div>
<p>그림 <a href="simple-reg-infer.html#fig:3-1-2">3.2</a>는 두 변수의 관계가 선형이 아닌 2차 함수의 관계에 있는 경우에 대한 예시 자료이다. 추정된 기울기는 0에 가까운 값을 갖고 있고, 가설 <span class="math inline">\(H_{0}:\beta_{1}=0, ~~H_{1}:\beta_{1} \ne 0\)</span> 에 대한 검정 결과 p-값은 0.839으로 계산되어 <span class="math inline">\(H_{0}\)</span> 을 기각하기 어려운 상황으로 보이지만, 두 변수 사이에는 명확한 관계가 있는 것을 알 수 있다.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:3-1-2"></span>
<img src="_main_files/figure-html/3-1-2-1.png" alt="$H_{0}:\beta_{1}=0$을 기각할 수 없는 상황: 두 변수 사이에 2차 함수 관계가 있는 경우" width="480" />
<p class="caption">
그림 3.2: <span class="math inline">\(H_{0}:\beta_{1}=0\)</span>을 기각할 수 없는 상황: 두 변수 사이에 2차 함수 관계가 있는 경우
</p>
</div>
<p>그림 <a href="simple-reg-infer.html#fig:3-1-3">3.3</a>도 두 변수의 관계가 선형이 아닌 2차 함수의 관계에 있는 경우에 대한 예시 자료이다.
이 경우에는 기울기의 추정 결과가 0.376으로 나오며, 검정 결과에서도 p-값이 0.0112로 계산되어서 유의수준 <span class="math inline">\(\alpha = 0.05\)</span> 에서 <span class="math inline">\(H_{0}\)</span>을 기각할 수 있는 자료이다. 하지만 <span class="math inline">\(X^{2}\)</span>을 포함시킨 회구모형 <span class="math inline">\(Y=\beta_{0}+\beta_{1}X+\beta_{2}X^{2}+\varepsilon\)</span> 이 더 적절한 모형으로 보인다.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:3-1-3"></span>
<img src="_main_files/figure-html/3-1-3-1.png" alt="$H_{0}:\beta_{1}=0$을 기각할 수 있지만, $X^{2}$을 포함한 2차 회귀모형이 더 좋은 결과를 보이는 경우" width="576" />
<p class="caption">
그림 3.3: <span class="math inline">\(H_{0}:\beta_{1}=0\)</span>을 기각할 수 있지만, <span class="math inline">\(X^{2}\)</span>을 포함한 2차 회귀모형이 더 좋은 결과를 보이는 경우
</p>
</div>
</div>
</div>
<div id="회귀계수-beta_0에-대한-추론" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> 회귀계수 <span class="math inline">\(\beta_{0}\)</span>에 대한 추론<a href="simple-reg-infer.html#회귀계수-beta_0에-대한-추론" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>회귀계수 <span class="math inline">\(\beta_{0}\)</span> 는 회귀직선의 Y축 절편을 나타내는 모수로서, 설명변수 <span class="math inline">\(X\)</span> 의 값이 0일 때 반응변수 <span class="math inline">\(Y\)</span>의 평균값을 나타낸다.
따라서 설명변수가 갖는 자료의 범위에 0이 포함되지 않는 경우에는 추론의 필요성이 크지 않은 모수가 된다.
또한 가설 <span class="math inline">\(H_{0}:\beta_{0}=0\)</span> 을 기각할 수 없는 경우에도 일반적으로는 모형에서 <span class="math inline">\(\beta_{0}\)</span> 를 제외시키지 않는다.</p>
<div id="hatbeta_0-의-표본분포" class="section level3 hasAnchor" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> <span class="math inline">\(\hat{\beta}_{0}\)</span> 의 표본분포<a href="simple-reg-infer.html#hatbeta_0-의-표본분포" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><a href="simple-reg.html#simple-reg">2</a>장에서 살펴본 <span class="math inline">\(\beta_{0}\)</span> 의 최소제곱추정량은 식 <a href="simple-reg.html#eq:lse-3">(2.6)</a>에서 다음과 같이 유도되었다.</p>
<p><span class="math display">\[\begin{equation}
\hat{\beta}_{0} = \overline{Y} - \hat{\beta}_{1} \overline{X}
\end{equation}\]</span></p>
<p><span class="math inline">\(\hat{\beta}_{1}\)</span> 이 식 <a href="simple-reg.html#eq:lse-p1">(2.7)</a>에서 <span class="math inline">\(Y_{i}\)</span> 의 선형결합으로 표현됨을 알 수 있기 때문에 <span class="math inline">\(\hat{\beta}_{0}\)</span> 도 자연스럽게 <span class="math inline">\(Y_{i}\)</span> 의 선형결합으로 표현됨을 알 수 있다.
따라서 <span class="math inline">\(\hat{\beta}_{0}\)</span> 도 <span class="math inline">\(Y_{i}\)</span> 와 같은 분포인 정규분포를 따르게 된다.</p>
<p><span class="math inline">\(\hat{\beta}_{0}\)</span> 의 평균과 분산은 식 <a href="simple-reg.html#eq:unbiased-beta0">(2.12)</a>과 식 <a href="simple-reg.html#eq:variance-beta0">(2.14)</a>에서 다음과 같이 유도되었다.</p>
<p><span class="math display">\[\begin{align*}
E\left(\hat{\beta}_{0}\right) &amp;= \beta_{0} \\
Var\left(\hat{\beta}_{0}\right) &amp;= \sigma^{2}\left(\frac{1}{n}+\frac{\overline{X}^{2}}{\sum_{i=1}^{n}(X_{i}-\overline{X})^{2}}\right)
\end{align*}\]</span></p>
<p>따라서 <span class="math inline">\(\hat{\beta}_{0}\)</span> 의 표본분포는 다음과 같다.</p>
<p><span class="math display">\[\begin{equation}
\hat{\beta}_{0} \sim N\left(\beta_{0},~ \sigma^{2}\left(\frac{1}{n}+\frac{\overline{X}^{2}}{\sum_{i=1}^{n}(X_{i}-\overline{X})^{2}}\right) \right)
\end{equation}\]</span></p>
</div>
<div id="beta_0의-신뢰구간" class="section level3 hasAnchor" number="3.2.2">
<h3><span class="header-section-number">3.2.2</span> <span class="math inline">\(\beta_{0}\)</span>의 신뢰구간<a href="simple-reg-infer.html#beta_0의-신뢰구간" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>모수 <span class="math inline">\(\beta_{0}\)</span> 의 신뢰구간은 <a href="simple-reg-infer.html#section-ci-beta1">3.1.2</a>절에서 <span class="math inline">\(\beta_{1}\)</span>의 신뢰구간을 유도할 때 사용했던 것과 동일한 방식으로 유도할 수 있다.
우선 <span class="math inline">\(\beta_{0}\)</span> 의 불편추정량인 <span class="math inline">\(\hat{\beta}_{0}\)</span> 을 표준화시킨 통계량 <span class="math inline">\(t\)</span> 는 다음과 같이 표현되며, 분포는 <span class="math inline">\(\hat{\beta}_{1}\)</span> 의 경우와 동일하게 <span class="math inline">\(t(n-2)\)</span>가 된다.</p>
<p><span class="math display" id="eq:dist-beta0">\[\begin{equation}
t = \frac{\hat{\beta}_{0}-\beta_{0}}{\sqrt{MSE\left(\frac{1}{n}+\frac{\overline{X}^{2}}{\sum_{i=1}^{n}(X_{i}-\overline{X})^{2}}\right)}} \sim t(n-2)
\tag{3.11}
\end{equation}\]</span></p>
<p>모수 <span class="math inline">\(\beta_{0}\)</span> 의 <span class="math inline">\(100 \times (1-\alpha)\)</span>% 신뢰구간은 식 <a href="simple-reg-infer.html#eq:dist-beta0">(3.11)</a>을 이용하면 다음과 같이 유도된다.</p>
<p><span class="math display" id="eq:ci-beta0">\[\begin{align}
1-\alpha &amp; = P \left( -t_{\alpha, n-2} &lt; \frac{\hat{\beta}_{0}-\beta_{0}}{SE(\hat{\beta}_{0})} &lt; t_{\alpha, n-2} \right) \\
&amp; = P \left( \hat{\beta}_{0} - t_{\alpha, n-2} \cdot SE(\hat{\beta}_{0}) &lt; \beta_{0} &lt; \hat{\beta}_{0} + t_{\alpha, n-2} \cdot SE(\hat{\beta}_{0}) \right)
\tag{3.12}
\end{align}\]</span></p>
<p>단, <span class="math inline">\(SE(\hat{\beta}_{0})=\sqrt{MSE\left(\frac{1}{n}+\frac{\overline{X}^{2}}{\sum(X_{i}-\overline{X})^{2}}\right)}\)</span> 을 나타내며, <span class="math inline">\(t_{\alpha, n-2}\)</span> 는 자유도가 <span class="math inline">\(n-2\)</span>인 <span class="math inline">\(t\)</span> 분포에서 상위 <span class="math inline">\(100 \times \alpha\)</span> 백분위수를 나타낸다.</p>
</div>
<div id="beta_0에-대한-가설검정" class="section level3 hasAnchor" number="3.2.3">
<h3><span class="header-section-number">3.2.3</span> <span class="math inline">\(\beta_{0}\)</span>에 대한 가설검정<a href="simple-reg-infer.html#beta_0에-대한-가설검정" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>모수 <span class="math inline">\(\beta_{0}\)</span> 에 대한 가설검정도 <a href="simple-reg-infer.html#section-test-beta1">3.1.3</a>절에서 살펴본 <span class="math inline">\(\beta_{1}\)</span> 의 가설검정의 경우와 동일한 방식으로 진행할 수 있다.
다음의 가설에 대하여</p>
<p><span class="math display">\[\begin{equation}
H_{0}: \beta_{0} = 0, ~~H_{1}: \beta_{0} \ne 0
\end{equation}\]</span></p>
<p>검정정통계량은 식 <a href="simple-reg-infer.html#eq:dist-beta0">(3.11)</a>을 근거로 다음과 같이 주어진다.</p>
<p><span class="math display" id="eq:test-beta0">\[\begin{equation}
t = \frac{\hat{\beta}_{0}}{SE(\hat{\beta}_{0})}
\tag{3.13}
\end{equation}\]</span></p>
<p>단, <span class="math inline">\(SE(\hat{\beta}_{0})=\sqrt{MSE\left(\frac{1}{n}+\frac{\overline{X}^{2}}{\sum(X_{i}-\overline{X})^{2}}\right)}\)</span>.</p>
<p><span class="math inline">\(H_{0}\)</span> 이 사실일 때 검정통계량은 분포는 <span class="math inline">\(t(n-2)\)</span>가 된다.</p>
<p>절차는 <span class="math inline">\(\beta_{1}\)</span> 의 경우와 동일하지만, 검정 결과의 적용 방식에는 큰 차이가 있다.</p>
<p><span class="math inline">\(\beta_{0}\)</span> 는 설명변수 <span class="math inline">\(X\)</span> 의 값이 0일 때 반응변수 <span class="math inline">\(Y\)</span>의 평균값을 나타내기 때문에, 설명변수가 갖는 자료의 범위에 0이 포함되지 않는 경우에는 추론의 필요성이 크지 않은 모수가 된다.
또한 가설 <span class="math inline">\(H_{0}:\beta_{0}=0\)</span> 을 기각할 수 없는 경우에도 모형에서 <span class="math inline">\(\beta_{0}\)</span> 를 제외시키지 않기 때문에, <span class="math inline">\(\beta_{0}\)</span> 에 대한 가설검정은 일반적으로 무시된다고 할 수 있다.</p>
<p>만일 가설 <span class="math inline">\(H_{0}:\beta_{0}=0\)</span> 의 검정 결과에 따라 모형에서 <span class="math inline">\(\beta_{0}\)</span> 를 제외시키게 되면, 회귀직선은 반드시 원점을 지나가야 하는데, 이것은 지나치게 강력한 제한사항이라고 할 수 있다.
예시 자료를 이용해서 이 문제를 살펴보자.
주어진 자료에 대해 식 <a href="simple-reg-infer.html#eq:simple-ch3-1">(3.1)</a>에 설정된 절편이 포함된 일반적인 단순회귀모형으로 추정된 회귀직선과 원점을 제거한 회귀모형인 <span class="math inline">\(Y=\beta_{1}X+\varepsilon\)</span> 으로 추정된 회귀직선이 그림 <a href="simple-reg-infer.html#fig:3-1-4">3.4</a>에 표시되어 있다.</p>
<p>주어진 자료에서 가설 <span class="math inline">\(H_{0}:\beta_{0}=0, ~~H_{1}:\beta_{0} \ne 0\)</span> 에 대한 p-값은 0.248으로 계산되어 <span class="math inline">\(H_{0}\)</span> 을 기각할 수 없는 상황이다.
두 회귀직선 사이에는 무시할 수 없는 차이가 있는 것으로 보이는데,
절편이 포함된 회귀직선의 경우에는 잔차제곱합이 <span class="math inline">\(RSS=\)</span> 118.98인 반면에, 절편이 제거되어 원점을 지나는 회귀직선의 경우에는 잔차제곱합이 <span class="math inline">\(RSS=\)</span> 124.89로 계산된다.
따라서 가설검정의 결과에 따라 절편을 제거한 회귀모형의 적합도가 더 떨어지는 것을 볼 수 있다.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:3-1-4"></span>
<img src="_main_files/figure-html/3-1-4-1.png" alt="절편을 제거한 회귀모형의 한계" width="576" />
<p class="caption">
그림 3.4: 절편을 제거한 회귀모형의 한계
</p>
</div>
<p><span class="math inline">\(\bullet\)</span> 예제 3.1: 매출액에 대한 광고효과 회귀모형의 회귀계수에 대한 추론</p>
<p>예제 2.2의 자료 <code>ex2-2.csv</code>에 대하여 다음의 분석을 실시해 보자.</p>
<ol style="list-style-type: decimal">
<li><p>광고비 지출이 매출액 증가에 양의 효과가 있는지 검정하라.</p></li>
<li><p>기울기 모수인 <span class="math inline">\(\beta_{1}\)</span>에 대한 95% 신뢰구간을 추정하라.</p></li>
</ol>
<p>회귀모형의 적합은 함수 <code>lm()</code>으로 이루어진다. 적합된 회귀모형에 대한 추론을 위해서는 <code>lm()</code>으로 생성된 객체에 다른 함수를 적용시켜 생성된 객체를 대상으로 이루어진다.
추론을 위해 사용되는 가장 대표적인 함수는 <code>summary()</code>이다.
자료 <code>ex2-2.csv</code>를 대상으로 회귀모형을 적합시켜보자.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="simple-reg-infer.html#cb12-1" tabindex="-1"></a>df2<span class="fl">.2</span> <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">&quot;Data/ex2-2.csv&quot;</span>)</span>
<span id="cb12-2"><a href="simple-reg-infer.html#cb12-2" tabindex="-1"></a>fit2<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(sales <span class="sc">~</span> advertisement, <span class="at">data =</span> df2<span class="fl">.2</span>)</span></code></pre></div>
<p>함수 <code>lm()</code>으로 생성된 객체 <code>fit2.2</code>에 회귀모형의 추론 단계에서 가장 빈번하게 사용되는 함수 <code>summary()</code>를 적용시킨 결과를 확인해 보자.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="simple-reg-infer.html#cb13-1" tabindex="-1"></a><span class="fu">summary</span>(fit2<span class="fl">.2</span>)</span>
<span id="cb13-2"><a href="simple-reg-infer.html#cb13-2" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb13-3"><a href="simple-reg-infer.html#cb13-3" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb13-4"><a href="simple-reg-infer.html#cb13-4" tabindex="-1"></a><span class="do">## lm(formula = sales ~ advertisement, data = df2.2)</span></span>
<span id="cb13-5"><a href="simple-reg-infer.html#cb13-5" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb13-6"><a href="simple-reg-infer.html#cb13-6" tabindex="-1"></a><span class="do">## Residuals:</span></span>
<span id="cb13-7"><a href="simple-reg-infer.html#cb13-7" tabindex="-1"></a><span class="do">##      Min       1Q   Median       3Q      Max </span></span>
<span id="cb13-8"><a href="simple-reg-infer.html#cb13-8" tabindex="-1"></a><span class="do">## -158.433  -15.093    0.557   21.674  151.973 </span></span>
<span id="cb13-9"><a href="simple-reg-infer.html#cb13-9" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb13-10"><a href="simple-reg-infer.html#cb13-10" tabindex="-1"></a><span class="do">## Coefficients:</span></span>
<span id="cb13-11"><a href="simple-reg-infer.html#cb13-11" tabindex="-1"></a><span class="do">##               Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb13-12"><a href="simple-reg-infer.html#cb13-12" tabindex="-1"></a><span class="do">## (Intercept)     -6.944     52.004  -0.134    0.895    </span></span>
<span id="cb13-13"><a href="simple-reg-infer.html#cb13-13" tabindex="-1"></a><span class="do">## advertisement   17.713      1.685  10.511 4.13e-09 ***</span></span>
<span id="cb13-14"><a href="simple-reg-infer.html#cb13-14" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb13-15"><a href="simple-reg-infer.html#cb13-15" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb13-16"><a href="simple-reg-infer.html#cb13-16" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb13-17"><a href="simple-reg-infer.html#cb13-17" tabindex="-1"></a><span class="do">## Residual standard error: 60.41 on 18 degrees of freedom</span></span>
<span id="cb13-18"><a href="simple-reg-infer.html#cb13-18" tabindex="-1"></a><span class="do">## Multiple R-squared:  0.8599, Adjusted R-squared:  0.8521 </span></span>
<span id="cb13-19"><a href="simple-reg-infer.html#cb13-19" tabindex="-1"></a><span class="do">## F-statistic: 110.5 on 1 and 18 DF,  p-value: 4.126e-09</span></span></code></pre></div>
<p>함수 <code>summary()</code>의 결과물은 SAS나 SPSS에서 볼 수 있는 결과물과는 형식에서 차이가 있으나, 많은 정보를 매우 효율적으로 보여주는 방식이라고 하겠다. 결과물을 하나씩 살펴보자.</p>
<p>먼저 <code>Residuals:</code>에는 잔차의 분포 형태를 엿볼 수 있는 요약통계가 계산되어 있다. 가정이 만족된다면 평균이 0인 정규분포를 보이게 되는데, 잔차의 요약통계 결과로 대략적인 판단을 할 수 있다.
잔차에 대한 분석은 <a href="reg-diag.html#reg-diag">5</a>장에서 살펴볼 것이다.</p>
<p><code>Coefficients:</code>에는 회귀계수의 추정값이 Estimate에, 표준오차가 Std. Error에 각각 계산되어 있다.
또한 개별 회귀계수의 유의성 검정인 <span class="math inline">\(H_{0}:\beta_{j} = 0, ~~H_{1}: \beta_{j} \ne 0\)</span> 에 대한 검정통계량의 값이 t value에, p-값이 Pr(&gt;|t|)이 각각 계산되어 있다.</p>
<p><code>Residual standard error:</code>는 식 <a href="simple-reg.html#eq:mse-1">(2.17)</a>에서 정의된 <span class="math inline">\(MSE\)</span> 에 제곱근을 취한 값으로 <span class="math inline">\(\sigma\)</span> 에 대한 추정 결과이며, 회귀모형의 평가 측도로 사용된다.
<code>Multiple R-squared:</code>와 <code>Adjusted R-squared:</code>, 그리고 <code>F-statistic:</code>의 내용은 추후에 살펴보겠다.</p>
<p>이제 예제 문제를 해결해 보자.
광고비 지출이 매출액 증가에 양의 효과가 있는지 여부를 확인하는 것은 식 <a href="simple-reg-infer.html#eq:hypo-beta1-2">(3.9)</a>와는 다르게 다음과 같은 단측검정이 된다.</p>
<p><span class="math display" id="eq:hypo-beta1-3">\[\begin{equation}
H_{0}:\beta_{1}=0, ~~H_{1}:\beta_{1}&gt;0
\tag{3.14}
\end{equation}\]</span></p>
<p>광고비 지출이 매출액 증가에는 음의 효과가 있을 수 없다는 확신이 있는 경우에만 적용할 수 있는 가설이며, 가설은 반드시 자료를 조사하기 전에 설정되어야 한다.</p>
<p>함수 <code>summary()</code>에서 계산한 p-값은 식 <a href="simple-reg-infer.html#eq:hypo-beta1-2">(3.9)</a>의 양측검정에 대한 것으로서, <span class="math inline">\(P(t &gt; |t_{0}|)\)</span> 을 계산한 것이다. 여기에서 <span class="math inline">\(t\)</span> 는 자유도가 <span class="math inline">\((n-2)\)</span> 인 <span class="math inline">\(t\)</span> 분포이고 <span class="math inline">\(|t_{0}|\)</span> 는 자료에서 계산된 검정통계량 값을 나타낸다. 식 <a href="simple-reg-infer.html#eq:hypo-beta1-3">(3.14)</a>의 단측검정에 대한 p-값은 <span class="math inline">\(P(t&gt;t_{0})\)</span>가 되는데, 예제 자료에서는 <span class="math inline">\(t_{0}=\)</span> 17.713으로 양수이므로 함수 <code>summary()</code>에서 계산한 p-값을 2로 나누면 된다.
따라서 양의 효과가 있는지 여부를 확인하는 가설의 p-값은 2.063186e-09 이 되어서,
<span class="math inline">\(H_{0}\)</span> 을 기각하는데 문제가 없어 보인다.
즉, 광고비 지출이 매출액 증가에 양의 효과가 있는 것으로 볼 수 있다.</p>
<p>회귀계수에 대한 신뢰구간은 함수 <code>lm()</code>으로 생성된 객체를 함수 <code>confint()</code>에 적용시키면 얻을 수 있다. 함수 <code>confint()</code>의 기본적인 사용법은 <code>confint(object, level = 0.95)</code>인데, <code>object</code>는 함수 <code>lm()</code>으로 생성된 객체이고, <code>level</code>은 신뢰수준을 지정하는 것으로서 95%가 디폴트 값이다.
이제 광고비 자료에 대한 회귀모형 객체인 <code>fit2.2</code>를 함수 <code>confint()</code>에 적용시킨 결과를 살펴보자.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="simple-reg-infer.html#cb14-1" tabindex="-1"></a><span class="fu">confint</span>(fit2<span class="fl">.2</span>)</span>
<span id="cb14-2"><a href="simple-reg-infer.html#cb14-2" tabindex="-1"></a><span class="do">##                    2.5 %    97.5 %</span></span>
<span id="cb14-3"><a href="simple-reg-infer.html#cb14-3" tabindex="-1"></a><span class="do">## (Intercept)   -116.20070 102.31274</span></span>
<span id="cb14-4"><a href="simple-reg-infer.html#cb14-4" tabindex="-1"></a><span class="do">## advertisement   14.17241  21.25336</span></span></code></pre></div>
<p>만일 90% 신뢰구간을 계산하고자 한다면, <code>level = 0.9</code>를 추가하면 된다.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="simple-reg-infer.html#cb15-1" tabindex="-1"></a><span class="fu">confint</span>(fit2<span class="fl">.2</span>, <span class="at">level =</span> <span class="fl">0.9</span>)</span>
<span id="cb15-2"><a href="simple-reg-infer.html#cb15-2" tabindex="-1"></a><span class="do">##                     5 %     95 %</span></span>
<span id="cb15-3"><a href="simple-reg-infer.html#cb15-3" tabindex="-1"></a><span class="do">## (Intercept)   -97.12253 83.23457</span></span>
<span id="cb15-4"><a href="simple-reg-infer.html#cb15-4" tabindex="-1"></a><span class="do">## advertisement  14.79064 20.63513</span></span></code></pre></div>
</div>
</div>
<div id="반응변수의-평균-eyx_o에-대한-신뢰구간-추정" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> 반응변수의 평균, <span class="math inline">\(E(Y|X_{o})\)</span>에 대한 신뢰구간 추정<a href="simple-reg-infer.html#반응변수의-평균-eyx_o에-대한-신뢰구간-추정" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>새롭게 관측되는 설명변수 자료에 대한 가장 정확한 반응변수의 예측값을 생성하는 것이 회귀분석의 목적이 되는 경우가 많이 있다.
반응변수의 예측값은 대부분의 경우 반응변수의 평균을 의미하는데, 경우에 따라서는 반응변수의 개별 관측값을 예측하고자 하는 경우도 있을 수 있다.
반응변수의 평균 예측에 대한 문제는 이번 절에서 살펴볼 것이고, 반응변수의 개별 관측값 예측에 대한 문제는 다음 절에서 살펴볼 것이다.</p>
<p>식 <a href="simple-reg-infer.html#eq:simple-ch3-1">(3.1)</a>의 회귀모형에 의하면, 반응변수 <span class="math inline">\(Y\)</span> 의 평균값은 설명변수의 값에 따라 다른 값을 갖게 된다.
따라서 반응변수의 평균을 예측하고자 하는 설명변수의 수준을 먼저 지정해야 하는데, 이 값을
<span class="math inline">\(X_{o}\)</span> 라고 하자.
그러면 지정된 설명변수 수준에 대한 반응변수의 평균값은 <span class="math inline">\(E(Y|X_{o})\)</span> 가 되는데,
이 때 설명변수의 수준 <span class="math inline">\(X_{o}\)</span> 는 현재 분석에 사용된 자료의 범위 내에서 지정하는 것이 안전하다.
그 이유는 그림 <a href="ch1.html#fig:1-5">1.5</a>에서 살펴본 회귀모형의 유의성 문제로 인하여, 현재 수집된 자료 범위를 벗어난 영역에 대해서는 가급적 예측을 실시하지 않는 것이 안전하기 때문이다.</p>
<p><span class="math inline">\(E(Y|X_{o})=\beta_{0}+\beta_{1}X_{o}\)</span> 에 대한 불편추정량은 <span class="math inline">\(\beta_{0}\)</span> 와 <span class="math inline">\(\beta_{1}\)</span> 에 대한 불편추정량을 각각 적용시켜서 다음과 같이 주어진다.</p>
<p><span class="math display" id="eq:simple-yhat-1">\[\begin{equation}
\widehat{E(Y|X_{o})} \equiv \widehat{Y}_{o}  = \hat{\beta}_{0} + \hat{\beta}_{1}X_{o}
\tag{3.15}
\end{equation}\]</span></p>
<p><span class="math inline">\(E(Y|X_{o})\)</span> 에 대한 신뢰구간을 추정하기 위해서는 <span class="math inline">\(E(Y|X_{o})\)</span> 의 불편추정량인 <span class="math inline">\(\widehat{Y}_{o}\)</span> 의 표본분포를 유도해야 한다.
<span class="math inline">\(\widehat{Y}_{o}\)</span> 은 <span class="math inline">\(\hat{\beta}_{0}\)</span> 와 <span class="math inline">\(\hat{\beta}_{1}\)</span> 의 선형결합으로 이루어져 있는데,
<span class="math inline">\(\hat{\beta}_{0}\)</span> 와 <span class="math inline">\(\hat{\beta}_{1}\)</span> 은 <a href="simple-reg.html#section-property-lse">2.2.2</a>절에서 살펴보았지만 모두 <span class="math inline">\(Y_{i}\)</span> 의 선형결합으로 표현된다.
따라서 <span class="math inline">\(\widehat{Y}_{o}\)</span> 은 <span class="math inline">\(Y_{i}\)</span> 와 동일하게 정규분포를 따르게 된다.</p>
<p>또한 <span class="math inline">\(\widehat{Y}_{o}\)</span> 의 분산은 다음과 같이 유도할 수 있다.</p>
<p><span class="math display" id="eq:simple-yhat-var">\[\begin{align}
Var(\widehat{Y}_{o}) &amp;= Var(\hat{\beta}_{0}+\hat{\beta}_{1}X_{o}) \\
&amp;= Var(\overline{Y}-\hat{\beta}_{1}\overline{X}+\hat{\beta}_{1}X_{O}) \\
&amp;= Var(\overline{Y}+\hat{\beta}_{1}(X_{o}-\overline{X})) \\
&amp;= \frac{\sigma^{2}}{n}+\frac{(X_{o}-\overline{X})^{2}\cdot \sigma^{2}}{\sum_{i=1}^{n}(X_{i}-\overline{X})^{2}} \\
&amp;= \sigma^{2}\left(\frac{1}{n}+\frac{(X_{o}-\overline{X})^{2}}{\sum_{i=1}^{n}(X_{i}-\overline{X})^{2}}\right)
\tag{3.16}
\end{align}\]</span></p>
<p>식 <a href="simple-reg-infer.html#eq:simple-yhat-var">(3.16)</a>의 세 번째에서 네 번째 단계로 넘어오는 과정에는 <span class="math inline">\(Cov(\overline{Y}, \hat{\beta}_{1})=0\)</span> 이 필요한데, 이것의 증명은 <a href="simple-reg.html#simple-reg">2</a>장 연습문제로 주어졌다.</p>
<p>따라서 <span class="math inline">\(\widehat{Y}_{o}\)</span> 의 표본분포는 다음과 같다.</p>
<p><span class="math display">\[\begin{equation}
\widehat{Y}_{o} \sim N\left(\beta_{0}+\beta_{1}X_{o},~\sigma^{2}\left(\frac{1}{n}+\frac{(X_{o}-\overline{X})^{2}}{\sum_{i=1}^{n}(X_{i}-\overline{X})^{2}}\right) \right)
\end{equation}\]</span></p>
<p><span class="math inline">\(E(Y|X_{o})\)</span> 의 불편추정량인 <span class="math inline">\(\widehat{Y}_{o}\)</span> 을 표준화시킨 통계량 <span class="math inline">\(t\)</span> 는 다음과 같이 표현되며, 분포는 <span class="math inline">\(\hat{\beta}_{1}\)</span>의 경우와 동일하게 <span class="math inline">\(t(n-2)\)</span> 가 된다.</p>
<p><span class="math display" id="eq:dist-simple-yhat">\[\begin{equation}
t = \frac{\widehat{Y}_{o}-E(Y|X_{o})}{\sqrt{MSE\left(\frac{1}{n}+\frac{(X_{o}-\overline{X})^{2}}{\sum_{i=1}^{n}(X_{i}-\overline{X})^{2}}\right)}}
\tag{3.17}
\end{equation}\]</span></p>
<p>모수 <span class="math inline">\(E(Y|X_{o})\)</span> 의 <span class="math inline">\(100 \times (1-\alpha)\)</span>% 신뢰구간은 식 <a href="simple-reg-infer.html#eq:dist-simple-yhat">(3.17)</a>을 이용하면 다음과 같이 유도된다.</p>
<p><span class="math display" id="eq:ci-simple-yhat">\[\begin{align}
1-\alpha &amp;= P\left(-t_{\alpha, n-2}&lt;\frac{\widehat{Y}_{o}-E(Y|X_{o})}{SE(\widehat{Y}_{o})}&lt;t_{\alpha, n-2} \right) \\
&amp;= P\left(\widehat{Y}_{o}-t_{\alpha, n-2}\cdot SE(\widehat{Y}_{o}) &lt; E(Y|X_{o}) &lt; \widehat{Y}_{o}+t_{\alpha, n-2}\cdot SE(\widehat{Y}_{o})\right)
\tag{3.18}
\end{align}\]</span></p>
<p>단, <span class="math inline">\(SE(\widehat{Y}_{o})) = \sqrt{MSE\left(\frac{1}{n}+\frac{(X_{o}-\overline{X})^{2}}{\sum_{i=1}^{n}(X_{i}-\overline{X})^{2}}\right)}\)</span> 을 나타내며, <span class="math inline">\(t_{\alpha, n-2}\)</span> 는 자유도가 <span class="math inline">\((n-2)\)</span> 인 <span class="math inline">\(t\)</span> 분포의 상위 <span class="math inline">\(100 \times \alpha\)</span> 백분위수를 나타낸다.</p>
<p>식 <a href="simple-reg-infer.html#eq:ci-simple-yhat">(3.18)</a>의 신뢰구간에서 확인할 수 있는 것은 신뢰구간의 폭이 <span class="math inline">\(X_{o} = \overline{X}\)</span> 일 때 최소가 되며, <span class="math inline">\(|X_{o}-\overline{X}|\)</span> 의 값이 증가함에 따라 점점 넓어진다는 점이다.
즉, <span class="math inline">\(E(Y|X_{o})\)</span> 에 대한 추정은 <span class="math inline">\(X_{o}\)</span> 의 값이 자료의 평균에 가까우면 좋은 결과를 기대할 수 있지만, 그렇지 않은 경우에는 신뢰도가 많이 떨어질 수 있다는 것을 의미한다.</p>
</div>
<div id="반응변수의-개별-관측값-예측" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> 반응변수의 개별 관측값 예측<a href="simple-reg-infer.html#반응변수의-개별-관측값-예측" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>이번 절에서는 주어진 설명변수의 수준에 대한 반응변수의 개별 관측값 예측에 대한 문제를 살펴보겠다.
이번 절에서도 미리 지정되는 설명변수의 수준을 <span class="math inline">\(X_{o}\)</span> 라고 하고, <span class="math inline">\(X_{o}\)</span> 에 해당하는 새로운 관측값을 <span class="math inline">\(Y_{o}\)</span> 라고 하자.
새로운 관측값 <span class="math inline">\(Y_{o}\)</span> 는 식 <a href="simple-reg-infer.html#eq:simple-ch3-1">(3.1)</a>의 회귀모형에 의해서 다음과 같이 주어진다.</p>
<p><span class="math display">\[\begin{equation}
Y_{o} = \beta_{0} + \beta_{1}X_{o} + \varepsilon_{o}
\end{equation}\]</span></p>
<p><span class="math inline">\(Y_{o}\)</span> 의 점추정량 <span class="math inline">\(\widehat{Y}_{o}\)</span> 을 구하기 위해서는 <span class="math inline">\(\beta_{0}\)</span> 와 <span class="math inline">\(\beta_{1}\)</span> 을 각각의 불편추정량으로 대체하고, 확률변수인 <span class="math inline">\(\varepsilon_{o}\)</span> 은 <span class="math inline">\(N(0,\sigma^{2})\)</span> 에 따른 임의의 값을 갖게 되기 때문에 정확한 값을 예측할 수 없는 대상이어서 평균값 0으로 적용시켜서 다음과 같이 구할 수 있다.</p>
<p><span class="math display" id="eq:simple-new-y">\[\begin{equation}
\widehat{Y}_{o} = \hat{\beta}_{0} + \hat{\beta}_{1}X_{o}
\tag{3.19}
\end{equation}\]</span></p>
<p>따라서 개별 관측값 <span class="math inline">\(Y_{o}\)</span> 와 평균 관측값 <span class="math inline">\(E(Y|X_{o})\)</span> 는 식 <a href="simple-reg-infer.html#eq:simple-yhat-1">(3.15)</a>와 <a href="simple-reg-infer.html#eq:simple-new-y">(3.19)</a>에 주어진 동일한 점추정량 <span class="math inline">\(\widehat{Y}_{o}\)</span> 을 갖게 된다.</p>
<p><span class="math inline">\(Y_{o}\)</span> 에 대한 예측구간을 추정하기 위해 다음의 확률변수를 고려해 보자.</p>
<p><span class="math display">\[\begin{equation}
\psi = \widehat{Y}_{o}-Y_{o}
\end{equation}\]</span></p>
<p>확률변수 <span class="math inline">\(\psi\)</span> 는 <span class="math inline">\(Y_{i}\)</span> 와 동일한 분포를 하기 때문에 정규분포를 따르고 있으며, 평균은 다음과 같고,
<span class="math display">\[\begin{align*}
E(\psi) &amp;= E(\widehat{Y}_{o}-Y_{o}) \\
&amp;= E(\hat{\beta}_{o}+\hat{\beta}_{1}X_{o}) - E(\beta_{0} + \beta_{1}X_{o} + \varepsilon_{o}) \\
&amp;= 0
\end{align*}\]</span></p>
<p>분산은 다음과 같이 유도된다.</p>
<p><span class="math display">\[\begin{align*}
Var(\psi) &amp;= Var(\widehat{Y}_{o}-Y_{o}) \\
&amp;= Var(\widehat{Y}_{o}) + Var(Y_{o}) \\
&amp;= \sigma^{2}\left(\frac{1}{n}+\frac{(X_{o}-\overline{X})^{2}}{\sum_{i=1}^{n}(X_{i}-\overline{X})^{2}}\right) + \sigma^{2} \\
&amp; = \sigma^{2}\left(1+\frac{1}{n}+\frac{(X_{o}-\overline{X})^{2}}{\sum_{i=1}^{n}(X_{i}-\overline{X})^{2}}\right)
\end{align*}\]</span></p>
<p>확률변수 <span class="math inline">\(\psi\)</span> 를 표준화시킨 통계량 <span class="math inline">\(t\)</span> 는 다음과 같이 표현되며, 분포는 <span class="math inline">\(t(n-2)\)</span> 가 된다.</p>
<p><span class="math display">\[\begin{equation}
t = \frac{\widehat{Y}_{o}-Y_{o}}{SE(\psi)}
\end{equation}\]</span></p>
<p>단, <span class="math inline">\(SE(\psi) = \sqrt{MSE\left(1+\frac{1}{n}+\frac{(X_{o}-\overline{X})^{2}}{\sum_{i=1}^{n}(X_{i}-\overline{X})^{2}}\right)}\)</span>.</p>
<p>따라서 미리 지정되는 설명변수의 수준 <span class="math inline">\(X_{o}\)</span> 에 대해 새롭게 관측될 개별 반응변수 값 <span class="math inline">\(Y_{o}\)</span> 의 <span class="math inline">\(100 \times (1-\alpha)\)</span>% 예측구간은 다음과 같이 주어진다.</p>
<p><span class="math display" id="eq:pi-simple-new-y">\[\begin{align*}
1-\alpha &amp;= P\left(-t_{\alpha, n-2}&lt;\frac{\widehat{Y}_{o}-Y_{o}}{SE(\psi)}&lt;t_{\alpha, n-2} \right) \\
&amp;=  P\left(\widehat{Y}_{o}-t_{\alpha, n-2}\cdot SE(\psi) &lt; Y_{o} &lt; \widehat{Y}_{o}+t_{\alpha, n-2}\cdot SE(\psi)\right)
\tag{3.20}
\end{align*}\]</span></p>
<p>지정된 설명변수 수준 <span class="math inline">\(X_{o}\)</span> 에 대한 반응변수의 평균에 대한 신뢰구간과 반응변수의 개별 관측값에 대한 예측구간의 폭을 비교해 보면, 식 <a href="simple-reg-infer.html#eq:pi-simple-new-y">(3.20)</a>의 예측구간이 식 <a href="simple-reg-infer.html#eq:ci-simple-yhat">(3.18)</a>의 신뢰구간보다 항상 더 넓다는 것을 알 수 있다.
이것은 예측구간이 <span class="math inline">\(E(Y|X_{o})\)</span> 을 <span class="math inline">\(\widehat{Y}_{o}\)</span> 으로 추정하는 과정에서 발생하는 오차와 새로운 관측값 <span class="math inline">\(Y_{o}\)</span> 에 의해 발생하는 오차를 모두 포함하기 때문이다.</p>
<p><span class="math inline">\(\bullet\)</span> 예제 3.2: 매출액에 대한 광고효과 회귀모형에서 매출액의 신뢰구간과 예측구간 추정</p>
<p>예제 2.2 자료 <code>ex2-2.csv</code>에 대하여 다음의 분석을 실시해 보자.</p>
<ol style="list-style-type: decimal">
<li><p>모형 적합에 사용된 광고비 자료에 대한 평균 매출액의 95% 신뢰구간과 매출액의 개별 관측값에 대한 95% 예측구간을 구하라.</p></li>
<li><p>피자 체인점들이 광고비를 25, 30, 35, 40을 각각 지출하면 얻게 될 것으로 예상되는 매출액의 평균은 어떻게 되는가? 평균 매출액에 대한 95% 신뢰구간을 구하라.</p></li>
<li><p>수원에 있는 어느 특정 피자 체인점이 광고비를 25, 30, 35, 40을 각각 지출하면 얻게 될 것으로 예측되는 매출액의 95% 예측구간을 구하라.</p></li>
</ol>
<p>적합된 회귀모형의 예측에 사용되는 함수는 <code>predict()</code>이다.
함수 <code>lm()</code>으로 생성된 회귀모형 객체에 대한 <code>predict()</code>의 기본적인 사용법은 다음과 같다.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="simple-reg-infer.html#cb16-1" tabindex="-1"></a><span class="fu">predict</span>(object, newdata, <span class="at">interval =</span> <span class="fu">c</span>(<span class="st">&quot;none&quot;</span>, <span class="st">&quot;confidence&quot;</span>, <span class="st">&quot;prediction&quot;</span>))</span></code></pre></div>
<p><code>object</code>는 함수 <code>lm()</code>으로 생성된 객체이고, <code>newdata</code>는 새롭게 주어지는 설명변수의 값으로 반드시 데이터 프레임으로 입력되어야 하며, 생략이 되면 모형적합에 사용된 자료에 대한 예측이 이루어진다.
<code>interval</code>은 구간의 종류를 선택하는 것으로서, 평균 반응변수에 대한 신뢰구간은 <code>"confidence"</code>, 반응변수의 개별 관측값에 대한 예측구간은 <code>"prediction"</code>을 선택하면 되고, 신뢰구간을 원하지 않는 경우에는 <code>"none"</code>을 선택하면 된다. 디폴트는 <code>"none"</code>이다.</p>
<p>자료 <code>ex2-2.csv</code>에 대하여 회귀모형 객체 <code>fit2.2</code>를 생성하자.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="simple-reg-infer.html#cb17-1" tabindex="-1"></a>df2<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;Data/ex2-2.csv&quot;</span>)</span>
<span id="cb17-2"><a href="simple-reg-infer.html#cb17-2" tabindex="-1"></a>fit2<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(sales <span class="sc">~</span> advertisement, <span class="at">data =</span> df2<span class="fl">.2</span>)</span></code></pre></div>
<p>예제의 첫 번째 문제는 모형적합에 사용된 광고비 자료에 대한 예측이다.
따라서 함수 <code>predict()</code>에 <code>newdata</code>를 지정하지 않고 <code>interval</code>을 <code>"confidence"</code>와 <code>"prediction"</code>을 각각 지정해서 평균 반응변수에 대한 신뢰구간과 개별 관측값에 대한 예측구간을 구하면 된다.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="simple-reg-infer.html#cb18-1" tabindex="-1"></a>pred_1 <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit2<span class="fl">.2</span>, <span class="at">interval =</span> <span class="st">&quot;confidence&quot;</span>)</span>
<span id="cb18-2"><a href="simple-reg-infer.html#cb18-2" tabindex="-1"></a>pred_2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit2<span class="fl">.2</span>, <span class="at">interval =</span> <span class="st">&quot;prediction&quot;</span>)</span></code></pre></div>
<p>두 구간의 폭은 그래프로 비교해 보자.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="simple-reg-infer.html#cb19-1" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb19-2"><a href="simple-reg-infer.html#cb19-2" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(df2<span class="fl">.2</span>, pred_1) <span class="sc">|&gt;</span> </span>
<span id="cb19-3"><a href="simple-reg-infer.html#cb19-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> advertisement, <span class="at">y =</span> sales)) <span class="sc">+</span></span>
<span id="cb19-4"><a href="simple-reg-infer.html#cb19-4" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb19-5"><a href="simple-reg-infer.html#cb19-5" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> lwr, <span class="at">ymax =</span> upr), <span class="at">alpha =</span> <span class="fl">0.1</span>, <span class="at">fill =</span> <span class="st">&quot;pink&quot;</span>,</span>
<span id="cb19-6"><a href="simple-reg-infer.html#cb19-6" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb19-7"><a href="simple-reg-infer.html#cb19-7" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;반응변수 평균에 대한 신뢰구간&quot;</span>)</span>
<span id="cb19-8"><a href="simple-reg-infer.html#cb19-8" tabindex="-1"></a></span>
<span id="cb19-9"><a href="simple-reg-infer.html#cb19-9" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(df2<span class="fl">.2</span>, pred_2) <span class="sc">|&gt;</span> </span>
<span id="cb19-10"><a href="simple-reg-infer.html#cb19-10" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> advertisement, <span class="at">y =</span> sales)) <span class="sc">+</span></span>
<span id="cb19-11"><a href="simple-reg-infer.html#cb19-11" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb19-12"><a href="simple-reg-infer.html#cb19-12" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> lwr, <span class="at">ymax =</span> upr), <span class="at">alpha =</span> <span class="fl">0.1</span>, <span class="at">fill =</span> <span class="st">&quot;skyblue&quot;</span>,</span>
<span id="cb19-13"><a href="simple-reg-infer.html#cb19-13" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb19-14"><a href="simple-reg-infer.html#cb19-14" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;반응변수 개별 관측값에 대한 예측구간&quot;</span>)</span>
<span id="cb19-15"><a href="simple-reg-infer.html#cb19-15" tabindex="-1"></a></span>
<span id="cb19-16"><a href="simple-reg-infer.html#cb19-16" tabindex="-1"></a>p1 <span class="sc">+</span> p2</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:ex3-2-1"></span>
<img src="_main_files/figure-html/ex3-2-1-1.png" alt="매출액 자료에 대한 신뢰구간과 예측구간 비교" width="864" />
<p class="caption">
그림 3.5: 매출액 자료에 대한 신뢰구간과 예측구간 비교
</p>
</div>
<p>예제의 두 번째와 세 번째 문제는 새롭게 주어진 설명변수 값에 대하여 평균 매출액에 대한 신뢰구간과 개별 관측값에 대한 예측구간을 추정하는 문제이다.
새롭게 주어진 설명변수 값을 데이터 프레임으로 지정하고, 예측을 실시해 보자.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="simple-reg-infer.html#cb20-1" tabindex="-1"></a>new_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">advertisement =</span> <span class="fu">c</span>(<span class="dv">25</span>, <span class="dv">30</span>, <span class="dv">35</span>, <span class="dv">40</span>))</span>
<span id="cb20-2"><a href="simple-reg-infer.html#cb20-2" tabindex="-1"></a>pred_3 <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit2<span class="fl">.2</span>, <span class="at">newdata =</span> new_data, <span class="at">interval =</span> <span class="st">&quot;confidence&quot;</span>)</span>
<span id="cb20-3"><a href="simple-reg-infer.html#cb20-3" tabindex="-1"></a>pred_4 <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit2<span class="fl">.2</span>, <span class="at">newdata =</span> new_data, <span class="at">interval =</span> <span class="st">&quot;prediction&quot;</span>)</span></code></pre></div>
<p>신뢰구간의 폭은 새롭게 주어지는 설명변수의 값이 자료의 평균인 29.8에 가까울수록 작아진다.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="simple-reg-infer.html#cb21-1" tabindex="-1"></a>new_data <span class="sc">|&gt;</span> <span class="fu">cbind</span>(pred_3) <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">width =</span> upr <span class="sc">-</span> lwr)</span>
<span id="cb21-2"><a href="simple-reg-infer.html#cb21-2" tabindex="-1"></a><span class="do">##   advertisement      fit      lwr      upr    width</span></span>
<span id="cb21-3"><a href="simple-reg-infer.html#cb21-3" tabindex="-1"></a><span class="do">## 1            25 435.8782 402.7979 468.9584 66.16044</span></span>
<span id="cb21-4"><a href="simple-reg-infer.html#cb21-4" tabindex="-1"></a><span class="do">## 2            30 524.4426 496.0525 552.8327 56.78018</span></span>
<span id="cb21-5"><a href="simple-reg-infer.html#cb21-5" tabindex="-1"></a><span class="do">## 3            35 613.0070 579.1774 646.8366 67.65917</span></span>
<span id="cb21-6"><a href="simple-reg-infer.html#cb21-6" tabindex="-1"></a><span class="do">## 4            40 701.5714 655.6407 747.5022 91.86146</span></span></code></pre></div>
<p>예측구간은 폭도 신뢰구간의 경우와 동일하게 자료의 평균에 가까울수록 작아지지만, 이 예제의 경우에는 상대적으로 큰 차이가 없는 것을 알 수 있다.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="simple-reg-infer.html#cb22-1" tabindex="-1"></a>new_data <span class="sc">|&gt;</span> <span class="fu">cbind</span>(pred_4) <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">width =</span> upr <span class="sc">-</span> lwr)</span>
<span id="cb22-2"><a href="simple-reg-infer.html#cb22-2" tabindex="-1"></a><span class="do">##   advertisement      fit      lwr      upr    width</span></span>
<span id="cb22-3"><a href="simple-reg-infer.html#cb22-3" tabindex="-1"></a><span class="do">## 1            25 435.8782 304.7133 567.0430 262.3297</span></span>
<span id="cb22-4"><a href="simple-reg-infer.html#cb22-4" tabindex="-1"></a><span class="do">## 2            30 524.4426 394.3814 654.5038 260.1224</span></span>
<span id="cb22-5"><a href="simple-reg-infer.html#cb22-5" tabindex="-1"></a><span class="do">## 3            35 613.0070 481.6512 744.3628 262.7117</span></span>
<span id="cb22-6"><a href="simple-reg-infer.html#cb22-6" tabindex="-1"></a><span class="do">## 4            40 701.5714 566.5916 836.5512 269.9596</span></span></code></pre></div>
</div>
<div id="상관계수-두-변수-사이의-선형-연관성-측정" class="section level2 hasAnchor" number="3.5">
<h2><span class="header-section-number">3.5</span> 상관계수 : 두 변수 사이의 선형 연관성 측정<a href="simple-reg-infer.html#상관계수-두-변수-사이의-선형-연관성-측정" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>두 변수 사이의 선형 관련성을 측정하는 통계량으로 식 <a href="simple-reg.html#eq:cov">(2.2)</a>에 정의된 공분산이 있다.
공분산의 값이 크면 두 변수 사이에 강한 양의 관계 또는 음의 관계가 있다고 할 수 있지만, 값이 작으면 선형 관계가 명확하지 않다고 할 수 있다.
그러나 공분산은 변수가 취하는 값 자체의 절대적 크기에도 영향을 받는 통계량이기 때문에, ‘값이 크다’ 또는 ’값이 작다’에 대한 절대적 기준을 제시할 수 없는데,
이 문제는 두 변수의 표준편차를 나누어 값을 상대화시킴으로서 해결할 수 있다.
이것이 두 변수의 상관계수 <span class="math inline">\(\rho\)</span> 가 된다.</p>
<p><span class="math display" id="eq:corr">\[\begin{equation}
\rho = \frac{Cov(Y,X)}{\sqrt{Var(Y)}\sqrt{Var(X)}}
\tag{3.21}
\end{equation}\]</span></p>
<p>상관계수는 <span class="math inline">\(-1 \leq \rho \leq 1\)</span> 의 범위를 취하고 있는데, <span class="math inline">\(1\)</span>과 <span class="math inline">\(-1\)</span>이 되면 두 변수가 완벽한 선형관계를 갖게 되고, <span class="math inline">\(0\)</span>에 가까울수록 명확한 선형관계가 없는 경우가 된다.
그림 <a href="simple-reg-infer.html#fig:corr-fig-1">3.6</a>은 상관관계의 값에 따라 두 변수의 산점도에 어떤 변화가 생길 수 있는지를 보여주는 모의자료에 대한 산점도이다.</p>
<div class="figure"><span style="display:block;" id="fig:corr-fig-1"></span>
<img src="_main_files/figure-html/corr-fig-1-1.png" alt="상관계수와 두 변수 산점도 형태" width="768" />
<p class="caption">
그림 3.6: 상관계수와 두 변수 산점도 형태
</p>
</div>
<p>공분산이나 상관계수는 두 변수가 모두 확률변수인 경우에 적용되는 개념이다.
그러나 식 <a href="simple-reg.html#eq:simple-1">(2.1)</a>에서 설정한 회귀모형에서 설명변수 <span class="math inline">\(X\)</span> 는 분석자가 통제할 수 있는 변량이고, 반응변수만 확률변수라고 가정하였다.
하지만 설명변수 <span class="math inline">\(X\)</span> 의 수준을 분석자가 임의로 조절하는 것이 불가능한 경우가 많이 있으며, 이런 상황에서는 변수 <span class="math inline">\(Y\)</span> 와 <span class="math inline">\(X\)</span> 가 모두 확률변수가 된다.</p>
<p>예를 들어 그림 <a href="ch1.html#fig:1-6-a">1.1</a>에서 다루고 있는 일일 최고 기온과 전기 사용량의 관계에서 설명변수인 일일 최고 기온의 수준은 분석자가 임의로 선택할 수 없는 변량이 된다.
또한 예제 2.2에서 다루고 있는 매출액에 대한 광고비 효과 자료에서도 실제로 우리는 피자 체인점을 임의로 선택해서 지출된 광고비와 매출액을 관측하는 것이기 때문에 광고비 수준을 분석자가 미리 설정하는 것은 어려운 상황이라고 할 수 있다.</p>
<p>이와 같이 설명변수도 확률변수인 경우에는 관측된 설명변수의 수준을 조건부로 하여 회귀모형에 대한 추론을 실시하게 된다.</p>
<p>식 <a href="simple-reg-infer.html#eq:corr">(3.21)</a>에 주어진 모수 <span class="math inline">\(\rho\)</span> 는 다음의 표본 상관계수로 추정할 수 있다.</p>
<p><span class="math display" id="eq:sample-corr">\[\begin{equation}
r = \frac{\sum_{i=1}^{n} (X_{i}-\overline{X})(Y_{i}-\overline{Y})}{\sqrt{\sum_{i=1}^{n} (X_{i}-\overline{X})^{2}}\sqrt{\sum_{i=1}^{n}(Y_{i}-\overline{Y})^{2}}}
\tag{3.22}
\end{equation}\]</span></p>
<p>상관계수의 유의성 검정은 다음의 가설에 대한 검정이다.</p>
<p><span class="math display">\[\begin{equation}
H_{0}: \rho = 0,~~H_{1}:\rho \ne 0
\end{equation}\]</span></p>
<p>검정통계량 <span class="math inline">\(t\)</span> 는 다음과 같이 주어지며, <span class="math inline">\(H_{0}\)</span> 이 사실인 경우의 분포는 <span class="math inline">\(t(n-2)\)</span> 가 된다.</p>
<p><span class="math display">\[\begin{equation}
t = \frac{r \sqrt{n-2}}{\sqrt{1-r^{2}}}
\end{equation}\]</span></p>
<p>상관계수의 유의성 검정으로 <span class="math inline">\(H_{0}\)</span> 이 기각되면, 두 변수 사이에 유의한 선형관계가 있다는 것을 의미한다.
하지만 그렇다고 해서 두 변수 사이에 강한 선형관계가 있다는 것을 의미하는 것은 아니다.
그림 <a href="simple-reg-infer.html#fig:corr-fig-1">3.6</a>에서 상관계수 값이 -0.29인 자료의 산점도를 보면 두 변수 사이에는 마치 선형관계가 없는 것으로 보인다.
하지만 상관계수의 유의성 검정을 실시하면 조금 다른 결과를 얻게 되는데,
상관계수의 유의성 검정은 함수 <code>cor.test()</code>로 할 수 있다.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="simple-reg-infer.html#cb23-1" tabindex="-1"></a><span class="fu">cor.test</span>(x,y)</span>
<span id="cb23-2"><a href="simple-reg-infer.html#cb23-2" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb23-3"><a href="simple-reg-infer.html#cb23-3" tabindex="-1"></a><span class="do">##  Pearson&#39;s product-moment correlation</span></span>
<span id="cb23-4"><a href="simple-reg-infer.html#cb23-4" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb23-5"><a href="simple-reg-infer.html#cb23-5" tabindex="-1"></a><span class="do">## data:  x and y</span></span>
<span id="cb23-6"><a href="simple-reg-infer.html#cb23-6" tabindex="-1"></a><span class="do">## t = -2.0846, df = 48, p-value = 0.04245</span></span>
<span id="cb23-7"><a href="simple-reg-infer.html#cb23-7" tabindex="-1"></a><span class="do">## alternative hypothesis: true correlation is not equal to 0</span></span>
<span id="cb23-8"><a href="simple-reg-infer.html#cb23-8" tabindex="-1"></a><span class="do">## 95 percent confidence interval:</span></span>
<span id="cb23-9"><a href="simple-reg-infer.html#cb23-9" tabindex="-1"></a><span class="do">##  -0.52441468 -0.01062909</span></span>
<span id="cb23-10"><a href="simple-reg-infer.html#cb23-10" tabindex="-1"></a><span class="do">## sample estimates:</span></span>
<span id="cb23-11"><a href="simple-reg-infer.html#cb23-11" tabindex="-1"></a><span class="do">##        cor </span></span>
<span id="cb23-12"><a href="simple-reg-infer.html#cb23-12" tabindex="-1"></a><span class="do">## -0.2881244</span></span></code></pre></div>
<p>검정 결과는 두 변수 사이에 유의한 선형관계가 존재하는 것으로 나왔다.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="simple-reg.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="multiple-reg.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
